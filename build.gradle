plugins {
    id 'java'
    id 'com.github.johnrengelman.shadow' version '1.2.4'
    id 'ninja.miserable.blossom' version '1.0.1'
}

group = 'de.lergin.sponge'
version = '1.3.2'

sourceCompatibility = '1.8'
targetCompatibility = '1.8'

defaultTasks 'buildPlugin'

repositories {
    mavenCentral()
    maven {
        name 'Sponge'
        url 'http://repo.spongepowered.org/maven'
    }
    maven {
        name 'bStats'
        url 'http://repo.bstats.org/content/repositories/releases/'
    }
}

dependencies {
    compile 'org.spongepowered:spongeapi:5.1.0'
    compile 'org.bstats:bstats-sponge:1.1'
}

blossom {
    def location = 'src/main/java/de/lergin/sponge/laborus/Laborus.java'

    replaceToken '@version@', project.version, location
}

task copyJar(type: Copy) {
    from shadowJar
    into '../TestServer/Forge/mods'
}

shadowJar {
    dependencies {
        include dependency("org.bstats:bstats-sponge")
    }

    relocate 'org.bstats', 'de.lergin.sponge.laborus'

    archiveName = "Laborus-${project.version}.jar"
}

task buildPlugin (dependsOn: [shadowJar, copyJar])

artifacts {
    archives shadowJar
}